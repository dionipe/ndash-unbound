<%- include('../partials/header-standalone') %>

<div class="mb-6">
    <a href="/zones/<%= zone.name %>" class="text-blue-600 hover:text-blue-700 flex items-center mb-4">
        <i class="fas fa-arrow-left mr-2"></i>
        Back to <%= zone.name %>
    </a>
    <h3 class="text-2xl font-bold text-gray-800">Edit DNS Record</h3>
    <p class="text-gray-600 mt-1">Update record for <%= zone.name %></p>
</div>

<% if (typeof error !== 'undefined' && error) { %>
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4">
        <i class="fas fa-exclamation-circle mr-2"></i>
        <%= decodeURIComponent(error) %>
    </div>
<% } %>

<div class="content-card max-w-2xl">
    <form method="POST" action="/records/<%= zone.name %>/<%= record.name %>/<%= record.type %>/edit" class="space-y-6">
        <div class="form-group">
            <label for="name" class="form-label">Record Name *</label>
            <input type="text" id="name" name="name" class="form-input" value="<%= record.name %>" required>
            <p class="form-help">Use @ for root domain, or enter a subdomain (e.g., www, mail)</p>
        </div>

        <div class="form-group">
            <label for="type" class="form-label">Record Type *</label>
            <select id="type" name="type" class="form-input" required>
                <option value="A" <%= record.type === 'A' ? 'selected' : '' %>>A - IPv4 Address</option>
                <option value="AAAA" <%= record.type === 'AAAA' ? 'selected' : '' %>>AAAA - IPv6 Address</option>
                <option value="CNAME" <%= record.type === 'CNAME' ? 'selected' : '' %>>CNAME - Canonical Name</option>
                <option value="MX" <%= record.type === 'MX' ? 'selected' : '' %>>MX - Mail Exchange</option>
                <option value="TXT" <%= record.type === 'TXT' ? 'selected' : '' %>>TXT - Text Record</option>
                <option value="NS" <%= record.type === 'NS' ? 'selected' : '' %>>NS - Name Server</option>
                <option value="PTR" <%= record.type === 'PTR' ? 'selected' : '' %>>PTR - Pointer</option>
                <option value="SRV" <%= record.type === 'SRV' ? 'selected' : '' %>>SRV - Service</option>
            </select>
        </div>

        <div class="form-group">
            <label for="value" class="form-label">Value *</label>
            <input type="text" id="value" name="value" class="form-input" value="<%= record.value %>" required>
            <p class="form-help">IP address, hostname, or value for this record</p>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="form-group">
                <label for="ttl" class="form-label">TTL (seconds)</label>
                <input type="number" id="ttl" name="ttl" class="form-input" value="<%= record.ttl || 3600 %>">
            </div>

            <div class="form-group" id="priority-group" style="display: <%= (record.type === 'MX' || record.type === 'SRV') ? 'block' : 'none' %>;">
                <label for="priority" class="form-label">Priority</label>
                <input type="number" id="priority" name="priority" class="form-input" value="<%= record.priority || '' %>" placeholder="10">
            </div>
        </div>

        <% if (record.type === 'SRV') { %>
        <div class="grid grid-cols-2 gap-4">
            <div class="form-group">
                <label for="weight" class="form-label">Weight</label>
                <input type="number" id="weight" name="weight" class="form-input" value="<%= record.weight || '' %>" placeholder="0">
            </div>

            <div class="form-group">
                <label for="port" class="form-label">Port</label>
                <input type="number" id="port" name="port" class="form-input" value="<%= record.port || '' %>" placeholder="80">
            </div>
        </div>
        <% } %>

        <div class="bg-blue-50 border border-blue-200 rounded p-4">
            <h4 class="font-semibold text-blue-900 mb-2">
                <i class="fas fa-info-circle mr-2"></i>
                What happens when you save?
            </h4>
            <ul class="text-sm text-blue-800 space-y-1">
                <li>• Original record will be replaced with new values</li>
                <li>• Zone serial number will be incremented</li>
                <li>• Zone syntax will be validated</li>
                <li>• Bind DNS service will be reloaded</li>
            </ul>
        </div>

        <div class="flex items-center space-x-4">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save mr-2"></i>
                Update Record
            </button>
            <a href="/zones/<%= zone.name %>" class="btn">
                Cancel
            </a>
        </div>
    </form>
</div>

<script>
    document.getElementById('type').addEventListener('change', function() {
        const priorityGroup = document.getElementById('priority-group');
        if (this.value === 'MX' || this.value === 'SRV') {
            priorityGroup.style.display = 'block';
        } else {
            priorityGroup.style.display = 'none';
        }
    });
</script>

<%- include('../partials/footer-standalone') %>
